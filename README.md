# REFORMERS Digital Twin Model API Server

## Overview

This package implements the server for REFORMERS Digital Twin Model API, according to the dedicated [OpenAPI specification](https://github.com/REFORMERS-EnergyValleys/reformers-dt-model-api-specs).
It is developed on top of stubs generated by the [OpenAPI Generator](https://openapi-generator.tech), see [here](./GENERATOR.md) for more details.

_Funding acknowledgement_:
The [REFORMERS project](https://reformers-energyvalleys.eu) has received funding from the European Unionâ€™s research and innovation programme Horizon Europe under the [Grant Agreement No.101136211](https://cordis.europa.eu/project/id/101136211)


## Requirements
Python 3.5.2+

## Usage
To run the server, please execute the following from the root directory:

```
pip3 install -r requirements.txt
python3 -m reformers_model_api_server
```

*Options*: provide as command line arguments

+ `-s TEXT`, `--specification TEXT`: OpenAPI specification file name
+ `-h TEXT`, `--host TEXT`: URL to repository
+ `-a TEXT`, `--auth-config TEXT`: path to authentication config file (see [`auth-config.json`](./auth-config.json) for an example)
+ `--remove-containers BOOLEAN`: set this to false to remove containers after they have exited
+ `--verify-ssl BOOLEAN` set this to false to skip verifying SSL certificates
+ `--help`: show help message and exit

Open your browser to here:

```
http://localhost:8080/ui/
```

The OpenAPI definition lives here:

```
http://localhost:8080/openapi.json
```

## Running with Docker

To run the server in a Docker container, execute the following from the root directory:

```bash
docker build -t reformers-model-api .

## Run server with Waitress WSGI server in docker container
docker run --rm -d -p 8080:80 -v /var/run/docker.sock:/var/run/docker.sock -v $PWD/auth-config.json:/auth-config.json reformers-model-api
```

*Options*: can be set as as environment variables for the container (flag `-e` / `--env`)

+ `SPECIFICATION`: OpenAPI specification file name
+ `HOST`: URL to repository
+ `AUTH_CONFIG`: path to authentication config file (see [`auth-config.json`](./auth-config.json) for an example)
+ `REMOVE_CONTAINERS`: set this to `false` (or `0`) to remove containers after they have exited
+ `VERIFY_SSL`: set this to `false` (or `0`) to skip verifying SSL certificates
